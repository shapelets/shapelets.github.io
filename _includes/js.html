<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<!-- Plugin JavaScript -->
<script src="{{ "js/jquery.easing.min.js" | prepend: site.baseurl }}"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<!-- Custom Theme JavaScript -->
<script src="js/landing-page.js"></script>

<script>
    $(document).on('submit', '#news', function(e) {
		e.preventDefault();	
			$('.col-md-4 form .input-group .input-group-btn #submit i').removeClass('fa fa-check');
			$('.col-md-4 form .input-group .input-group-btn #submit i').addClass('fa fa-spinner fa-spin');
			$.ajax({
				url : 'https://shapelets.us19.list-manage.com/subscribe/post-json?&c=?',
				type : 'get',
                cache : false,
                dataType : 'json',
                contentType: "application/json; charset=utf-8",
				data : $(this).serialize(),
				success : function(data) {
					$('.col-md-4 form .input-group .input-group-btn #submit i').addClass('fa fa-check');
					$('.col-md-4 form .input-group .input-group-btn #submit i').removeClass('fa-spinner fa-spin');
					$('.col-md-4 .success_msg').html("<p><strong>Your Request was successfully sent.</strong> Thank you!</p>");
			},
			error : function(xhr, err) {
				$('.col-md-4 form .input-group .input-group-btn #submit i').addClass('fa fa-check');
				$('.col-md-4 form .input-group .input-group-btn #submit i').removeClass('fa fa-spinner fa-spin');
				$('.col-md-4 .success_msg').html("<p class='alert alert-danger'>Oops!! An error occurred.</p>");
			}
		});
		return false;
	});

    $(document).on('keyup', '#input', function(e) {
		// console.log(e.keyCode);
		var pattern = new RegExp(/^[+a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i);
        if(!pattern.test($(this).val()))
        {
        	$('#submit').removeClass('success').addClass('error');
        }
        else{
        	$('#submit').removeClass('error').addClass('success');
        }
	});
</script>

<script>
    if (matchMedia) {
        const mq = window.matchMedia("(max-width: 600px)");
        mq.addListener(WidthChange);
        WidthChange(mq);
    }

    function WidthChange(mq) {
        let bios = document.getElementsByClassName("bio-card immobile");
        if (mq.matches) {
            $(".bio-card").addClass("mobile").removeClass("immobile");
        } else {
            $(".bio-card").removeClass("mobile").addClass("immobile");
        }
    }
    $(".team-member").on("click", ".bio-card", function(event) {
        $(".bio-card").removeClass("active");
        $(event.currentTarget).addClass("active");
    });
    $(".bio-card").children(".exit-button").on("click", function(event) {
        event.stopPropagation();
        $(event.currentTarget).parent().removeClass("active");
    });
</script>

<script>
    let canSubmit = true;
    $('#contactForm').submit(event => {
        event.preventDefault();

        let form = {
            firstName : $('input[name="firstName"]').val(),
            lastName : $('input[name="lastName"]').val(),
            companyName : $('input[name="companyName"]').val(),
            companyEmail : $('input[name="companyEmail"]').val(),
            description : $('textarea[name="description"]').val() || 'no-description',
            phone : $('input[name="phone"]').val() || 'no-phone'
        };
        if(canSubmit){
            canSubmit = false;
            $('button[type="submit"]').html(`<div class="spinner-border" role="status">
                                                    <span class="sr-only">Loading...</span>
                                                    </div>`);
            $.post('https://server-shapelets-io-3001.herokuapp.com/api/contact', form, (data) => {
                canSubmit = true;
                $('input[name="firstName"]').val('');
                $('input[name="lastName"]').val('');
                $('input[name="companyName"]').val('');
                $('input[name="companyEmail"]').val('');
                $('textarea[name="description"]').val('');
                $('input[name="phone"]').val('');
                $('button[type="submit"]').html('SUBMIT');
                $('.contact-message').html('Thanks for your request. We will ritch you shortly.');
                $('.contact-message').show();
            }).fail(error => {
                canSubmit = true;
                $('input[name="firstName"]').val('');
                $('input[name="lastName"]').val('');
                $('input[name="companyName"]').val('');
                $('input[name="companyEmail"]').val('');
                $('textarea[name="description"]').val('');
                $('input[name="phone"]').val('');
                $('button[type="submit"]').html('SUBMIT');
                $('.contact-message').html('It seems to be something wrong. Try again!');
                $('.contact-message').show();
            });
        }
    });
</script>

<script>
    // Scroll function courtesy of Scott Dowding; http://stackoverflow.com/questions/487073/check-if-element-is-visible-after-scrolling
    $(document).ready(function() {
        // Check if element is scrolled into view
        function isScrolledIntoView(elem) {
            var docViewTop = $(window).scrollTop();
            var docViewBottom = docViewTop + $(window).height();

            var elemTop = $(elem).offset().top;
            var elemBottom = elemTop + $(elem).height();

            return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
        }
        // If element is scrolled into view, fade it in
        $(window).scroll(function() {
            $('.scroll-animations .animated').each(function() {
                if (isScrolledIntoView(this) === true) {
                    $(this).addClass('fadeInDown');
                }
            });
        });
    });
</script>
<script>
    $(window).scroll(function (event) {
        var scroll = $(window).scrollTop();
        if(scroll <= 20){
            $('nav.navbar').removeClass('nav-shadow');
        }else{
            $('nav.navbar').addClass('nav-shadow');
        }
    });
</script>